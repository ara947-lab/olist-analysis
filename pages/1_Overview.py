import streamlit as st
from utils import load_data

# ----------------------
# 데이터 로드
# ----------------------
df = load_data()

total_seller = len(df)
risk_ratio = (df["risk_stage"] != "normal").mean() * 100

# ----------------------
# 타이틀
# ----------------------
st.title("📌 Overview")

# ----------------------
# KPI 영역
# ----------------------
col1, col2 = st.columns(2)

with col1:
    st.metric("전체 판매자 수", f"{total_seller:,}")

with col2:
    st.metric("이탈 위험 판매자 비율", f"{risk_ratio:.1f}%")

st.divider()

# ----------------------
# 분석 배경
# ----------------------
st.subheader("분석 배경")

st.markdown(
    """
일반적으로 판매자 이탈은 **리뷰 점수 하락** 때문이라고 가정된다.  
그러나 실제 데이터에서는 **이탈 직전 판매자의 리뷰 점수는 큰 차이가 없다.**

본 분석은 다음 질문에서 출발한다.

> **“판매자는 언제, 어떤 신호를 보이며 이탈하기 시작하는가?”**
"""
)

# ----------------------
# 핵심 가설
# ----------------------
st.subheader(" 핵심 가설")

st.markdown(
    """
- 이탈은 특정 시점에 갑자기 발생하지 않는다  
- **주문 수 감소 → 활동 일수 감소 → 매출 감소**의 흐름을 따른다  
- 리뷰 점수는 **원인이 아니라 결과 지표**에 가깝다
"""
)

# ----------------------
# 대시보드 읽는 법
# ----------------------
st.subheader("대시보드 구성 안내")

st.markdown(
    """
- **Risk Stage** : 판매자를 행동 기반 단계로 구분  
- **Metrics** : 주문 수 · 활동 일수 · 매출의 단계별 차이 비교  
- **Next Action** : Stage별 개입 전략 제안
"""
)

st.info("⬅ 좌측 메뉴에서 단계별 분석을 확인하세요.")
